<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Analysis Result for {{ ticker }}</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 2em; }
    .container { max-width: 600px; margin: auto; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { padding: 8px 12px; border: 1px solid #ddd; }
    th { background-color: #f4f4f4; text-align: left; }
    .center { text-align: center; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Analysis for {{ ticker }}</h1>
    <table>
      <tr>
        <th>Metric</th>
        <th>Value</th>
      </tr>
      <tr>
        <td>Turnover Growth</td>
        <td class="center" {% if metrics.avg_turnover_growth is not none and metrics.avg_turnover_growth > 0.1 %} style="background-color: lightgreen;" {% endif %}>
          {{ metrics.avg_turnover_growth is not none and (metrics.avg_turnover_growth * 100)|round(2) ~ '%' or 'N/A' }}
        </td>
      </tr>
      <tr>
        <td>FCF Growth</td>
        <td class="center" {% if metrics.avg_FCF_growth is not none and metrics.avg_FCF_growth > 0.1 %} style="background-color: lightgreen;" {% endif %}>
          {{ metrics.avg_FCF_growth is not none and (metrics.avg_FCF_growth * 100)|round(2) ~ '%' or 'N/A' }}
        </td>
      </tr>
      <tr>
        <td>ROCE (using FCF)</td>
        <td class="center" {% if metrics.avg_ROCE_using_FCF is not none and metrics.avg_ROCE_using_FCF > 0.15 %} style="background-color: lightgreen;" {% endif %}>
          {{ metrics.avg_ROCE_using_FCF is not none and (metrics.avg_ROCE_using_FCF * 100)|round(2) ~ '%' or 'N/A' }}
        </td>
      </tr>
      <tr>
        <td>Net Debt/FCF</td>
        <td class="center" {% if metrics.latest_net_debt_to_FCF is not none and metrics.latest_net_debt_to_FCF < 3 %} style="background-color: lightgreen;" {% endif %}>
          {{ metrics.latest_net_debt_to_FCF is not none and metrics.latest_net_debt_to_FCF|round(2) or 'N/A' }}
        </td>
      </tr>
      <tr>
        <td>Share Number Increase</td>
        <td class="center" {% if metrics.avg_stock_increase is not none and metrics.avg_stock_increase <= 0 %} style="background-color: lightgreen;" {% endif %}>
          {{ metrics.avg_stock_increase is not none and (metrics.avg_stock_increase * 100)|round(2) ~ '%' or 'N/A' }}
        </td>
      </tr>
      <tr>
        <td>FCF Margin</td>
        <td class="center" {% if metrics.avg_FCF_margin is not none and metrics.avg_FCF_margin > 0.1 %} style="background-color: lightgreen;" {% endif %}>
          {{ metrics.avg_FCF_margin is not none and (metrics.avg_FCF_margin * 100)|round(2) ~ '%' or 'N/A' }}
        </td>
      </tr>
      <tr>
        <td>Average PER (5y)</td>
        <td class="center">
          {{ metrics.average_per is not none and metrics.average_per|round(2) or 'N/A' }}
        </td>
      </tr>
      <tr>
        <td>PER TTM</td>
        <td class="center" {% if metrics.ttm_per is not none and metrics.average_per is not none and metrics.ttm_per < metrics.average_per %} style="background-color: lightgreen;" {% endif %}>
          {{ metrics.ttm_per is not none and metrics.ttm_per|round(2) or 'N/A' }}
        </td>
      </tr>
      <tr>
        <td>PER (latest quarter)</td>
        <td class="center">
          {{ metrics.latest_per is not none and metrics.latest_per|round(2) or 'N/A' }}
        </td>
      </tr>
      <tr>
        <td>Fiscal Date Ending</td>
        <td class="center">
          {{ metrics.fiscal_date_ending or 'N/A' }}
        </td>
      </tr>
      <tr>
        <td>Stock Price</td>
        <td class="center">
          {{ metrics.latest_price is not none and metrics.latest_price|round(2) or 'N/A' }}
        </td>
      </tr>
    </table>    
    <p class="center"><a href="{{ url_for('index') }}">Analyze another stock</a></p>
  </div>
</body>
</html>
